#VRML V2.0 utf8

#Couloir secret
#Un bouton ouvre la porte ronde en pierre

Shape #Couloir
{
	appearance Appearance
	{
		material Material
		{
			diffuseColor .3 .4 .16
		}
	}
	geometry Extrusion
	{
		crossSection	#Triangle pour le toit
		[
			-.5 0
			-.5 1
			.5 1
			.5 0
			-.5 0
		]
		
		spine
		[
			0 0 0
			0 0 -6
		]
		
		solid FALSE
		beginCap FALSE
		endCap FALSE
	}
} #/Couloir

Transform #Bouton
{
	translation 1 .75 0
	children DEF Bouton Transform
	{
		children
		[
			DEF BoutonSensor TouchSensor { }
			
			Shape
			{
				geometry Box
				{
					size .2 .1 .025
				}
				appearance Appearance
				{
					material Material
					{
						diffuseColor .3 .4 .16
					}
				}
			}
		]
	}
} #/Bouton

Transform #Porte
{
	translation 0 .5 -.101 
	rotation 1 0 0 1.57
	children
	[
		DEF Porte Transform
		{			
			children 
			[
				Shape
				{
					geometry Cylinder
					{
						radius .7
						height .2
					}
					appearance Appearance
					{					
						texture ImageTexture
						{
							url "AnubisTexture.jpg"
						}
					}
				}
				
				Shape
				{
					geometry Cylinder
					{
						radius .701
						height .201
					}
					appearance Appearance
					{					
						material Material
						{
							diffuseColor 1 1 1
							transparency .7
						}
					}
				}
			]
		}
	]
}

DEF PorteTimer TimeSensor 
{
    cycleInterval 10 # La porte sera hors du chemin après cette intervale
    loop FALSE
    startTime 0
    stopTime 0
}

#ATTENTION POUR RÉALISME:
#	si l'orientation change de: angle (radians)
# 	la position doit changer de: angle*rayon

DEF PorteRotation OrientationInterpolator 
{
    key [ 0, 1 ]
    keyValue [ 0 1 0 0,  0 1 0 1.57]	
}

DEF PorteTranslation PositionInterpolator 
{
    key [ 0, 1 ]
    keyValue [ 0 0 0, -1.1 0 0 ]	
}

#Bouton: Lorsqu'on l'appuie, il entre dans le mur
DEF BoutonTimer TimeSensor 
{
    cycleInterval .1 # La porte sera hors du chemin après cette intervale
    loop FALSE
    startTime 0
    stopTime 0
}

DEF BoutonTranslation PositionInterpolator 
{
    key [ 0 ]
    keyValue [ 0 0 -.025 ]	
}


ROUTE PorteTimer.fraction_changed TO PorteRotation.set_fraction
ROUTE PorteRotation.value_changed TO Porte.set_rotation

ROUTE PorteTimer.fraction_changed TO PorteTranslation.set_fraction
ROUTE PorteTranslation.value_changed TO Porte.set_translation

ROUTE BoutonTimer.fraction_changed TO BoutonTranslation.set_fraction
ROUTE BoutonTranslation.value_changed TO Bouton.set_translation


ROUTE BoutonSensor.touchTime TO PorteTimer.set_startTime
ROUTE BoutonSensor.touchTime TO BoutonTimer.set_startTime


